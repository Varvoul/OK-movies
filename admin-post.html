<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Posts Management - Quravel Admin</title>
    
    <!-- Embedded CSS Styles -->
    <style>
        /* =============================================================================
           ADMIN PANEL STYLES (Embedded from admin.css and main.css)
           ============================================================================= */
        
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #0a0e1a 0%, #1a1f35 100%);
            color: #e8eaf6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        html {
            scroll-behavior: smooth;
        }

        /* Color System */
        :root {
            --primary-500: #F83D45;
            --primary-700: #D92630;
            --bg-page: #252433;
            --bg-surface-1: #2D2F40;
            --bg-surface-2: #3A3C52;
            --text-primary: #E8E8F0;
            --text-secondary: #B8B8C8;
            --text-disabled: #8E8E9E;
            --border-standard: #3D3F4A;
            --border-focus: #F83D45;
            --badge-4k: #A162F7;
            --badge-hd: #4D8AF0;
            
            /* Spacing */
            --spacing-xs: 8px;
            --spacing-sm: 12px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
            --spacing-xxl: 64px;
            
            /* Border Radius */
            --radius-sm: 8px;
            --radius-md: 12px;
            
            /* Container */
            --container-max-width: 1440px;
            --container-padding: 32px;
            
            /* Admin Colors */
            --admin-bg: rgba(15, 23, 42, 0.95);
            --admin-border: rgba(139, 92, 246, 0.2);
            --admin-primary: #8b5cf6;
            --admin-secondary: rgba(139, 92, 246, 0.1);
            --admin-danger: rgba(239, 68, 68, 0.2);
            --admin-success: rgba(34, 197, 94, 0.2);
            --admin-warning: rgba(245, 158, 11, 0.2);
        }

        /* Admin Container */
        .admin-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Admin Header */
        .admin-header {
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .admin-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
        }

        .admin-nav .logo img {
            height: 40px;
            max-width: 150px;
        }

        /* Scrollable Navigation Menu */
        .admin-nav-links {
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
            scrollbar-width: thin;
            scrollbar-color: rgba(139, 92, 246, 0.5) transparent;
            padding: 0.5rem 0;
            scroll-behavior: smooth;
            max-width: 800px;
        }

        .admin-nav-links::-webkit-scrollbar {
            height: 6px;
        }

        .admin-nav-links::-webkit-scrollbar-track {
            background: rgba(139, 92, 246, 0.1);
            border-radius: 3px;
        }

        .admin-nav-links::-webkit-scrollbar-thumb {
            background: rgba(139, 92, 246, 0.5);
            border-radius: 3px;
        }

        .admin-nav-links::-webkit-scrollbar-thumb:hover {
            background: rgba(139, 92, 246, 0.7);
        }

        .admin-nav-link {
            color: #a5b4fc;
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: all 0.3s ease;
            white-space: nowrap;
            flex-shrink: 0;
            min-width: max-content;
        }

        .admin-nav-link:hover,
        .admin-nav-link.active {
            color: #f5f3ff;
            background: rgba(139, 92, 246, 0.1);
        }

        /* Navigation Scroll Arrows */
        .nav-scroll-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(139, 92, 246, 0.3);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .nav-scroll-btn:hover {
            opacity: 1;
            background: rgba(139, 92, 246, 0.5);
        }

        .nav-scroll-left {
            left: -15px;
        }

        .nav-scroll-right {
            right: -15px;
        }

        /* Admin Main Content */
        .admin-main {
            flex: 1;
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        .admin-content {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .admin-header-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .admin-header-section h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #8b5cf6, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .admin-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        /* Buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: #415b82;
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(65, 91, 130, 0.3);
        }

        .btn-secondary {
            background: rgba(139, 92, 246, 0.1);
            color: #8b5cf6;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        .btn-secondary:hover {
            background: rgba(139, 92, 246, 0.2);
            transform: translateY(-1px);
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
        }

        .btn-edit {
            background: rgba(59, 130, 246, 0.2);
            color: #93c5fd;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .btn-delete {
            background: rgba(239, 68, 68, 0.2);
            color: #f87171;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        /* Posts Table */
        .posts-table {
            overflow-x: auto;
            background: rgba(15, 23, 42, 0.7);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
        }

        .posts-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .posts-table th,
        .posts-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid rgba(139, 92, 246, 0.1);
        }

        .posts-table th {
            background: rgba(139, 92, 246, 0.1);
            color: #f5f3ff;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .posts-table td {
            color: #e8eaf6;
        }

        .posts-table tr:hover {
            background: rgba(139, 92, 246, 0.05);
        }

        /* Post Type Badges */
        .post-type-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .post-type-movie {
            background: rgba(34, 197, 94, 0.2);
            color: #4ade80;
        }

        .post-type-anime {
            background: rgba(168, 85, 247, 0.2);
            color: #c084fc;
        }

        .post-type-tv-show {
            background: rgba(59, 130, 246, 0.2);
            color: #93c5fd;
        }

        /* Content Flags */
        .content-flags {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .flag {
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
        }

        .flag-slideshow {
            background: rgba(245, 158, 11, 0.2);
            color: #fbbf24;
        }

        .flag-top-airing {
            background: rgba(239, 68, 68, 0.2);
            color: #f87171;
        }

        .flag-latest {
            background: rgba(34, 197, 94, 0.2);
            color: #4ade80;
        }

        .flag-recommended {
            background: rgba(168, 85, 247, 0.2);
            color: #c084fc;
        }

        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            backdrop-filter: blur(5px);
        }

        .modal.active {
            display: block;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 20px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-large {
            max-width: 1000px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
        }

        .modal-header h2 {
            color: #f5f3ff;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .close {
            color: #a5b4fc;
            font-size: 2rem;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: #f5f3ff;
        }

        /* Form Styles */
        .post-form {
            padding: 1.5rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            margin-bottom: 1rem;
        }

        .form-group label {
            color: #f5f3ff;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 0.75rem;
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 8px;
            background: rgba(15, 23, 42, 0.8);
            color: #e8eaf6;
            font-size: 0.9rem;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #8b5cf6;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .form-group input[type="range"] {
            -webkit-appearance: none;
            background: rgba(139, 92, 246, 0.2);
            height: 6px;
            border-radius: 3px;
            outline: none;
        }

        .form-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #8b5cf6;
            border-radius: 50%;
            cursor: pointer;
        }

        #popularity-value {
            color: #8b5cf6;
            font-weight: 600;
            margin-left: 1rem;
        }

        /* Checkbox Group */
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            color: #e8eaf6;
            font-size: 0.9rem;
        }

        .checkbox-label input[type="checkbox"] {
            display: none;
        }

        .checkmark {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 4px;
            position: relative;
            transition: all 0.3s ease;
        }

        .checkbox-label input[type="checkbox"]:checked + .checkmark {
            background: #8b5cf6;
            border-color: #8b5cf6;
        }

        .checkbox-label input[type="checkbox"]:checked + .checkmark::after {
            content: 'âœ“';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(139, 92, 246, 0.2);
        }

        /* Compose Modal Styles */
        .compose-tabs {
            display: flex;
            border-bottom: 2px solid #334155;
            margin-bottom: 20px;
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 12px 24px;
            cursor: pointer;
            color: #94A3B8;
            font-weight: 500;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .tab-btn:hover {
            color: #E4E4E7;
            background: rgba(34, 211, 238, 0.05);
        }

        .tab-btn.active {
            color: #22D3EE;
            border-bottom-color: #22D3EE;
            background: rgba(34, 211, 238, 0.05);
        }

        .compose-mode {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .compose-mode.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Template Selection */
        .template-selection h3 {
            color: #E4E4E7;
            margin-bottom: 16px;
            font-size: 18px;
        }

        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }

        .template-card {
            border: 2px solid #334155;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            background: #101828;
            position: relative;
            overflow: hidden;
        }

        .template-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(34, 211, 238, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .template-card:hover {
            border-color: #22D3EE;
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(34, 211, 238, 0.15);
        }

        .template-card:hover::before {
            opacity: 1;
        }

        .template-card.selected {
            border-color: #22D3EE;
            background: linear-gradient(135deg, rgba(34, 211, 238, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
            box-shadow: 0 4px 16px rgba(34, 211, 238, 0.2);
        }

        .template-card.selected::before {
            opacity: 1;
        }

        .template-preview {
            position: relative;
            z-index: 1;
        }

        .template-preview h4 {
            color: #E4E4E7;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .template-preview p {
            color: #94A3B8;
            font-size: 14px;
            line-height: 1.4;
        }

        /* Template-specific previews */
        .movie-template-preview {
            background: linear-gradient(135deg, #1a2332 0%, #2d3748 100%);
            border-radius: 8px;
            padding: 20px;
            margin: -20px;
            color: white;
            text-align: center;
        }

        .tv-template-preview {
            background: linear-gradient(135deg, #2d1b69 0%, #553c9a 100%);
            border-radius: 8px;
            padding: 20px;
            margin: -20px;
            color: white;
            text-align: center;
        }

        .news-template-preview {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            border-radius: 8px;
            padding: 20px;
            margin: -20px;
            color: white;
            text-align: center;
        }

        .custom-template-preview {
            background: linear-gradient(135deg, #4a5568 0%, #718096 100%);
            border-radius: 8px;
            padding: 20px;
            margin: -20px;
            color: white;
            text-align: center;
        }

        /* HTML Editor */
        .html-editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            background: #101828;
            border: 1px solid #334155;
            border-radius: 8px;
            padding: 12px 16px;
        }

        .html-editor-header h3 {
            color: #E4E4E7;
            margin: 0;
            font-size: 16px;
        }

        .editor-actions {
            display: flex;
            gap: 8px;
        }

        .html-editor-container {
            border: 2px solid #334155;
            border-radius: 8px;
            overflow: hidden;
            background: #101828;
        }

        .html-editor-container textarea {
            width: 100%;
            min-height: 400px;
            border: none;
            outline: none;
            padding: 16px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            color: #E4E4E7;
            background: transparent;
        }

        /* HTML Preview */
        .html-preview {
            margin-top: 20px;
            border: 2px solid #334155;
            border-radius: 8px;
            padding: 16px;
            background: #101828;
        }

        .html-preview h4 {
            color: #E4E4E7;
            margin-bottom: 12px;
        }

        .html-preview iframe {
            width: 100%;
            height: 400px;
            border: 1px solid #334155;
            border-radius: 4px;
            background: white;
        }

        /* Templates Manager */
        .templates-management {
            padding: 1.5rem;
        }

        .template-actions {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid #334155;
        }

        .templates-list h3 {
            color: #E4E4E7;
            margin-bottom: 16px;
            font-size: 18px;
        }

        .saved-templates-grid {
            display: grid;
            gap: 16px;
        }

        .saved-template-card {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            border: 2px solid #334155;
            border-radius: 12px;
            background: #101828;
            transition: all 0.3s ease;
        }

        .saved-template-card:hover {
            border-color: #22D3EE;
            transform: translateY(-1px);
        }

        .template-info h4 {
            color: #E4E4E7;
            margin-bottom: 4px;
            font-size: 16px;
        }

        .template-info p {
            color: #94A3B8;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .template-date {
            color: #64748B;
            font-size: 12px;
        }

        .no-templates {
            text-align: center;
            color: #94A3B8;
            padding: 40px;
            font-style: italic;
        }

        /* Notification Styles */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 20px;
            border-radius: 8px;
            color: white;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 10000;
            max-width: 400px;
            animation: slideIn 0.3s ease;
            font-weight: 500;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .notification-success {
            background: linear-gradient(135deg, #22C55E, #16A34A);
        }

        .notification-error {
            background: linear-gradient(135deg, #EF4444, #DC2626);
        }

        .notification-warning {
            background: linear-gradient(135deg, #F59E0B, #D97706);
        }

        .notification-info {
            background: linear-gradient(135deg, #3B82F6, #2563EB);
        }

        .notification button {
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            padding: 0;
            margin-left: auto;
            opacity: 0.8;
            transition: opacity 0.2s ease;
        }

        .notification button:hover {
            opacity: 1;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* SVG Icons */
        .icon {
            width: 20px;
            height: 20px;
            display: inline-block;
            vertical-align: middle;
            margin-right: 6px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        .icon-template {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='3' width='18' height='18' rx='2' ry='2'%3E%3C/rect%3E%3Cline x1='3' y1='9' x2='21' y2='9'%3E%3C/line%3E%3Cline x1='9' y1='21' x2='9' y2='9'%3E%3C/line%3E%3C/svg%3E");
        }

        .icon-code {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='16 18 22 12 16 6'%3E%3C/polyline%3E%3Cpolyline points='8 6 2 12 8 18'%3E%3C/polyline%3E%3C/svg%3E");
        }

        .icon-add {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cline x1='12' y1='5' x2='12' y2='19'%3E%3C/line%3E%3Cline x1='5' y1='12' x2='19' y2='12'%3E%3C/line%3E%3C/svg%3E");
        }

        .icon-edit {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7'%3E%3C/path%3E%3Cpath d='M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z'%3E%3C/path%3E%3C/svg%3E");
        }

        .icon-delete {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='3 6 5 6 21 6'%3E%3C/polyline%3E%3Cpath d='M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2'%3E%3C/path%3E%3C/svg%3E");
        }

        .icon-save {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z'%3E%3C/path%3E%3Cpolyline points='17 21 17 13 7 13 7 21'%3E%3C/polyline%3E%3Cpolyline points='7 3 7 8 15 8'%3E%3C/polyline%3E%3C/svg%3E");
        }

        .icon-preview {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z'%3E%3C/path%3E%3Ccircle cx='12' cy='12' r='3'%3E%3C/circle%3E%3C/svg%3E");
        }

        .icon-download {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4'%3E%3C/path%3E%3Cpolyline points='7 10 12 15 17 10'%3E%3C/polyline%3E%3Cline x1='12' y1='15' x2='12' y2='3'%3E%3C/line%3E%3C/svg%3E");
        }

        .icon-upload {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4'%3E%3C/path%3E%3Cpolyline points='17 8 12 3 7 8'%3E%3C/polyline%3E%3Cline x1='12' y1='3' x2='12' y2='15'%3E%3C/line%3E%3C/svg%3E");
        }

        .icon-arrow-left {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='15 18 9 12 15 6'%3E%3C/polyline%3E%3C/svg%3E");
        }

        .icon-arrow-right {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='9 18 15 12 9 6'%3E%3C/polyline%3E%3C/svg%3E");
        }

        /* Quill Editor Styles */
        .ql-toolbar {
            background: rgba(15, 23, 42, 0.8) !important;
            border: 1px solid rgba(139, 92, 246, 0.3) !important;
            border-radius: 8px 8px 0 0 !important;
        }

        .ql-container {
            background: rgba(15, 23, 42, 0.8) !important;
            border: 1px solid rgba(139, 92, 246, 0.3) !important;
            border-radius: 0 0 8px 8px !important;
            min-height: 200px;
        }

        .ql-editor {
            color: #e8eaf6 !important;
            font-family: 'Inter', sans-serif;
        }

        .ql-toolbar button {
            color: #a5b4fc !important;
        }

        .ql-toolbar button:hover {
            color: #8b5cf6 !important;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .admin-nav-links {
                max-width: 600px;
            }
        }

        @media (max-width: 768px) {
            .admin-main {
                padding: 1rem;
            }

            .admin-header {
                padding: 1rem;
            }

            .admin-nav {
                flex-direction: column;
                gap: 1rem;
            }

            .admin-nav-links {
                width: 100%;
                max-width: 100%;
                justify-content: flex-start;
            }

            .nav-scroll-left,
            .nav-scroll-right {
                display: none !important;
            }

            .admin-header-section {
                flex-direction: column;
                align-items: stretch;
            }

            .admin-header-section h1 {
                font-size: 2rem;
            }

            .admin-actions {
                flex-direction: column;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .checkbox-group {
                grid-template-columns: 1fr;
            }

            .modal-content {
                width: 95%;
                margin: 1rem;
            }

            .posts-table {
                font-size: 0.8rem;
            }

            .posts-table th,
            .posts-table td {
                padding: 0.5rem;
            }

            .template-grid {
                grid-template-columns: 1fr;
            }

            .saved-template-card {
                flex-direction: column;
                gap: 12px;
                align-items: stretch;
            }
        }

        @media (max-width: 480px) {
            .admin-actions {
                flex-direction: column;
            }

            .template-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Loading States */
        .loading {
            opacity: 0.7;
            pointer-events: none;
        }

        .skeleton {
            background: linear-gradient(90deg, #2D2F40 25%, #3A3C52 50%, #2D2F40 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }
    </style>
    
    <!-- Quill.js CSS -->
    <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
</head>
<body>
    <div class="admin-container">
        <!-- Admin Header -->
        <header class="admin-header">
            <div class="admin-nav">
                <a href="index.html" class="logo">
                    <img src="https://via.placeholder.com/150x40/8b5cf6/ffffff?text=Quravel+Admin" alt="Quravel Logo">
                </a>
                
                <!-- Navigation Scroll Buttons -->
                <button class="nav-scroll-btn nav-scroll-left" id="scrollLeft">
                    <span class="icon icon-arrow-left"></span>
                </button>
                
                <nav class="admin-nav-links" id="adminNav">
                    <a href="admin.html" class="admin-nav-link">Dashboard</a>
                    <a href="admin-status.html" class="admin-nav-link">Status</a>
                    <a href="admin-header.html" class="admin-nav-link">Header and Menu</a>
                    <a href="admin-homepage.html" class="admin-nav-link">Homepage</a>
                    <a href="admin-slideshow.html" class="admin-nav-link">Slideshow</a>
                    <a href="admin-posts.html" class="admin-nav-link active">Posts</a>
                    <a href="admin-streaming.html" class="admin-nav-link">Streaming Page</a>
                    <a href="admin-footer.html" class="admin-nav-link">Footer and Settings</a>
                    <a href="admin-users.html" class="admin-nav-link">User Management</a>
                    <a href="admin-analytics.html" class="admin-nav-link">Analytics</a>
                    <a href="admin-settings.html" class="admin-nav-link">System Settings</a>
                    <a href="admin-backup.html" class="admin-nav-link">Backup & Restore</a>
                </nav>
                
                <button class="nav-scroll-btn nav-scroll-right" id="scrollRight">
                    <span class="icon icon-arrow-right"></span>
                </button>
            </div>
        </header>

        <!-- Admin Main Content -->
        <main class="admin-main">
            <div class="admin-content">
                <div class="admin-header-section">
                    <h1>Posts Management</h1>
                    <div class="admin-actions">
                        <button class="btn btn-primary" onclick="showAddPostModal()">
                            <span class="icon icon-add"></span>
                            Add New Post
                        </button>
                        <button class="btn btn-secondary" onclick="showComposeModal()">
                            <span class="icon icon-template"></span>
                            Compose Content
                        </button>
                        <button class="btn btn-secondary" onclick="manageTemplates()">
                            <span class="icon icon-save"></span>
                            Manage Templates
                        </button>
                        <button class="btn btn-secondary" onclick="importPosts()">
                            <span class="icon icon-upload"></span>
                            Import Posts
                        </button>
                        <button class="btn btn-secondary" onclick="exportPosts()">
                            <span class="icon icon-download"></span>
                            Export Data
                        </button>
                    </div>
                </div>

                <!-- Posts Table -->
                <div class="posts-table">
                    <table id="posts-table">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Type</th>
                                <th>Category</th>
                                <th>Flags</th>
                                <th>Popularity</th>
                                <th>Date Added</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="posts-table-body">
                            <!-- Posts will be loaded dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <!-- Compose Modal -->
    <div id="compose-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Compose Content</h2>
                <span class="close" onclick="closeComposeModal()">&times;</span>
            </div>
            
            <!-- Compose Mode Tabs -->
            <div class="compose-tabs">
                <button class="tab-btn active" onclick="switchComposeMode('template')">
                    <span class="icon icon-template"></span>
                    Template Mode
                </button>
                <button class="tab-btn" onclick="switchComposeMode('html')">
                    <span class="icon icon-code"></span>
                    HTML Code Mode
                </button>
            </div>

            <!-- Template Mode -->
            <div id="template-mode" class="compose-mode active">
                <div class="template-selection">
                    <h3>Choose Template</h3>
                    <div class="template-grid">
                        <div class="template-card" onclick="selectTemplate('movie-card')">
                            <div class="template-preview movie-template-preview">
                                <h4>Movie Card</h4>
                                <p>Standard movie/show card layout</p>
                            </div>
                        </div>
                        <div class="template-card" onclick="selectTemplate('tv-show')">
                            <div class="template-preview tv-template-preview">
                                <h4>TV Show</h4>
                                <p>Multi-episode TV show layout</p>
                            </div>
                        </div>
                        <div class="template-card" onclick="selectTemplate('news-article')">
                            <div class="template-preview news-template-preview">
                                <h4>News Article</h4>
                                <p>Article/blog post layout</p>
                            </div>
                        </div>
                        <div class="template-card" onclick="selectTemplate('custom')">
                            <div class="template-preview custom-template-preview">
                                <h4>Custom</h4>
                                <p>Build your own layout</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="template-editor" id="template-editor" style="display: none;">
                    <h3>Customize Template</h3>
                    <form id="template-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="compose-title">Title *</label>
                                <input type="text" id="compose-title" name="title" required>
                            </div>
                            <div class="form-group">
                                <label for="compose-type">Type *</label>
                                <select id="compose-type" name="type" required>
                                    <option value="">Select Type</option>
                                    <option value="movie">Movie</option>
                                    <option value="tv-show">TV Show</option>
                                    <option value="anime">Anime</option>
                                    <option value="news">News</option>
                                    <option value="review">Review</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="compose-category">Category</label>
                                <select id="compose-category" name="category">
                                    <option value="">Select Category</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="compose-tags">Tags</label>
                                <input type="text" id="compose-tags" name="tags" placeholder="Action, Drama, etc.">
                            </div>
                        </div>

                        <!-- Rich Text Content Editor -->
                        <div class="form-group">
                            <label for="compose-content">Content</label>
                            <div id="content-editor"></div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="compose-poster">Poster URL</label>
                                <input type="url" id="compose-poster" name="poster">
                            </div>
                            <div class="form-group">
                                <label for="compose-backdrop">Backdrop URL</label>
                                <input type="url" id="compose-backdrop" name="backdrop">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="compose-year">Year</label>
                                <input type="number" id="compose-year" name="year" min="1900" max="2030">
                            </div>
                            <div class="form-group">
                                <label for="compose-rating">Rating</label>
                                <input type="number" id="compose-rating" name="rating" min="0" max="10" step="0.1">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Content Options</label>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="isFeatured">
                                    <span class="checkmark"></span>
                                    Featured Content
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="isRecommended">
                                    <span class="checkmark"></span>
                                    Recommended
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="isTopAiring">
                                    <span class="checkmark"></span>
                                    Top Airing
                                </label>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- HTML Code Mode -->
            <div id="html-mode" class="compose-mode">
                <div class="html-editor-header">
                    <h3>HTML Code Editor</h3>
                    <div class="editor-actions">
                        <button class="btn btn-small btn-secondary" onclick="formatHTML()">Format</button>
                        <button class="btn btn-small btn-secondary" onclick="validateHTML()">Validate</button>
                        <button class="btn btn-small btn-secondary" onclick="previewHTML()">
                            <span class="icon icon-preview"></span>
                            Preview
                        </button>
                    </div>
                </div>
                <div class="html-editor-container">
                    <textarea id="html-editor"></textarea>
                </div>
                <div class="html-preview" id="html-preview" style="display: none;">
                    <h4>Preview</h4>
                    <iframe id="preview-frame" sandbox="allow-same-origin"></iframe>
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="btn btn-secondary" onclick="closeComposeModal()">Cancel</button>
                <button type="button" class="btn btn-secondary" onclick="saveAsDraft()">Save Draft</button>
                <button type="button" class="btn btn-primary" onclick="publishContent()">Publish</button>
            </div>
        </div>
    </div>

    <!-- Templates Manager Modal -->
    <div id="templates-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Templates Management</h2>
                <span class="close" onclick="closeTemplatesModal()">&times;</span>
            </div>
            
            <div class="templates-management">
                <div class="template-actions">
                    <button class="btn btn-primary" onclick="createNewTemplate()">
                        <span class="icon icon-add"></span>
                        Create New Template
                    </button>
                    <button class="btn btn-secondary" onclick="importTemplate()">
                        <span class="icon icon-upload"></span>
                        Import Template
                    </button>
                    <button class="btn btn-secondary" onclick="exportAllTemplates()">
                        <span class="icon icon-download"></span>
                        Export All
                    </button>
                </div>

                <div class="templates-list">
                    <h3>Saved Templates</h3>
                    <div id="saved-templates" class="saved-templates-grid">
                        <!-- Saved templates will be loaded dynamically -->
                        <div class="no-templates">No templates saved yet. Create your first template!</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Post Modal -->
    <div id="add-post-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Post</h2>
                <span class="close" onclick="closeAddPostModal()">&times;</span>
            </div>
            <form id="add-post-form" class="post-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="post-title">Title *</label>
                        <input type="text" id="post-title" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="post-type">Type *</label>
                        <select id="post-type" name="type" required>
                            <option value="">Select Type</option>
                            <option value="movie">Movie</option>
                            <option value="anime">Anime</option>
                            <option value="tv-show">TV Show</option>
                            <option value="news">News</option>
                            <option value="review">Review</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="post-category">Category *</label>
                        <select id="post-category" name="category" required>
                            <option value="">Select Category</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="post-year">Year</label>
                        <input type="number" id="post-year" name="year" min="1900" max="2030">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="post-duration">Duration</label>
                        <input type="text" id="post-duration" name="duration" placeholder="e.g., 2h 30m or 24 episodes">
                    </div>
                    <div class="form-group">
                        <label for="post-rating">Rating</label>
                        <input type="number" id="post-rating" name="rating" min="0" max="10" step="0.1">
                    </div>
                </div>

                <div class="form-group">
                    <label for="post-description">Description</label>
                    <textarea id="post-description" name="description" rows="3"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="post-poster">Poster URL</label>
                        <input type="url" id="post-poster" name="poster">
                    </div>
                    <div class="form-group">
                        <label for="post-backdrop">Backdrop URL</label>
                        <input type="url" id="post-backdrop" name="backdrop">
                    </div>
                </div>

                <div class="form-group">
                    <label for="post-genres">Genres (comma-separated)</label>
                    <input type="text" id="post-genres" name="genres" placeholder="Action, Adventure, Sci-Fi">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="post-director">Director/Creator</label>
                        <input type="text" id="post-director" name="director">
                    </div>
                    <div class="form-group">
                        <label for="post-trailer">Trailer URL</label>
                        <input type="url" id="post-trailer" name="trailer">
                    </div>
                </div>

                <div class="form-group">
                    <label for="post-cast">Cast (comma-separated)</label>
                    <input type="text" id="post-cast" name="cast" placeholder="Actor 1, Actor 2, Actor 3">
                </div>

                <!-- Content Flags -->
                <div class="form-group">
                    <label>Content Flags</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" name="isFeatured">
                            <span class="checkmark"></span>
                            Featured (Hero Carousel)
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="isSlideshow">
                            <span class="checkmark"></span>
                            Slideshow Post
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="isTopAiring">
                            <span class="checkmark"></span>
                            Top Airing
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="isLatestMovie">
                            <span class="checkmark"></span>
                            Latest Movie
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="isRecommended">
                            <span class="checkmark"></span>
                            Recommended
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="post-tags">Tags (comma-separated)</label>
                    <input type="text" id="post-tags" name="tags" placeholder="action, thriller, popular">
                </div>

                <div class="form-group">
                    <label for="post-popularity">Popularity Score</label>
                    <input type="range" id="post-popularity" name="popularity" min="0" max="100" value="50">
                    <span id="popularity-value">50</span>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeAddPostModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Post</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Embedded JavaScript -->
    <script src="https://cdn.quilljs.com/1.3.7/quill.min.js"></script>
    <script>
        // =============================================================================
        // MAIN APPLICATION - Posts Management System
        // =============================================================================
        
        // Global variables
        let postsData = [];
        let savedTemplates = [];
        let contentDraft = null;
        let quillEditor = null;
        let currentComposeMode = 'template';
        let selectedTemplate = '';

        // DOM Elements
        const postsTableBody = document.getElementById('posts-table-body');
        const adminNav = document.getElementById('adminNav');
        const scrollLeftBtn = document.getElementById('scrollLeft');
        const scrollRightBtn = document.getElementById('scrollRight');
        const composeModal = document.getElementById('compose-modal');
        const templatesModal = document.getElementById('templates-modal');
        const addPostModal = document.getElementById('add-post-modal');
        const postPopularity = document.getElementById('post-popularity');
        const popularityValue = document.getElementById('popularity-value');
        const htmlEditor = document.getElementById('html-editor');
        const previewFrame = document.getElementById('preview-frame');
        const savedTemplatesContainer = document.getElementById('saved-templates');
        
        // Sample posts data
        const samplePosts = [
            {
                id: 1,
                title: "The Last Guardian",
                type: "movie",
                category: "Action",
                flags: ["slideshow", "recommended"],
                popularity: 85,
                date: "2024-01-15",
                rating: 8.7,
                description: "A thrilling adventure about survival and courage.",
                poster: "https://via.placeholder.com/300x450/8b5cf6/ffffff?text=Movie+Poster"
            },
            {
                id: 2,
                title: "Cyberpunk Chronicles",
                type: "anime",
                category: "Sci-Fi",
                flags: ["top-airing", "latest"],
                popularity: 92,
                date: "2024-01-14",
                rating: 9.2,
                description: "A futuristic tale of humanity and technology.",
                poster: "https://via.placeholder.com/300x450/8b5cf6/ffffff?text=Anime+Poster"
            },
            {
                id: 3,
                title: "Kingdom of Shadows",
                type: "tv-show",
                category: "Fantasy",
                flags: ["featured"],
                popularity: 78,
                date: "2024-01-13",
                rating: 8.1,
                description: "An epic fantasy series with magical elements.",
                poster: "https://via.placeholder.com/300x450/8b5cf6/ffffff?text=TV+Show+Poster"
            },
            {
                id: 4,
                title: "Neo Tokyo Stories",
                type: "anime",
                category: "Drama",
                flags: ["recommended"],
                popularity: 88,
                date: "2024-01-12",
                rating: 8.9,
                description: "Emotional stories set in a futuristic Tokyo.",
                poster: "https://via.placeholder.com/300x450/8b5cf6/ffffff?text=Anime+Poster"
            },
            {
                id: 5,
                title: "Arctic Expedition",
                type: "movie",
                category: "Adventure",
                flags: ["latest"],
                popularity: 75,
                date: "2024-01-11",
                rating: 7.8,
                description: "A dangerous expedition to the North Pole.",
                poster: "https://via.placeholder.com/300x450/8b5cf6/ffffff?text=Movie+Poster"
            }
        ];

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApplication();
        });

        function initializeApplication() {
            loadPosts();
            loadTemplates();
            setupNavigationScroll();
            setupEventListeners();
            initializeEditors();
            
            // Load initial posts.json data if not exists
            const initialJsonData = localStorage.getItem('quravel_json_posts');
            if (!initialJsonData) {
                // Load sample data from your posts.json file structure
                const sampleJsonData = {
                    posts: [
                        // Your sample posts from posts.json would go here
                        // Or load from an external file
                    ],
                    categories: {
                        movies: ["action", "sci-fi", "comedy", "drama", "thriller", "horror", "romance", "adventure"],
                        anime: ["action", "romance", "comedy", "drama", "thriller", "fantasy", "isekai", "slice-of-life"],
                        "tv-shows": ["drama", "comedy", "thriller", "sci-fi", "reality", "documentary"]
                    },
                    contentFlags: {
                        slideshow: "Featured content for homepage hero carousel",
                        topAiring: "Currently popular/running series",
                        latestMovie: "Recently released movies",
                        recommended: "Editor picks and recommendations"
                    }
                };
                
                // Optionally, you could load your existing posts.json file content here
                // For now, we'll save the structure
                localStorage.setItem('quravel_json_posts', JSON.stringify(sampleJsonData));
            }
        }

        // =============================================================================
        // POSTS MANAGEMENT FUNCTIONS
        // =============================================================================

        function loadPosts() {
            postsData = JSON.parse(localStorage.getItem('quravel_posts')) || samplePosts;
            postsTableBody.innerHTML = '';
            
            if (postsData.length === 0) {
                postsTableBody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #a5b4fc;">No posts found. Add your first post!</td></tr>';
                return;
            }
            
            postsData.forEach(post => {
                const row = createPostRow(post);
                postsTableBody.appendChild(row);
            });
        }

        function createPostRow(post) {
            const row = document.createElement('tr');
            row.dataset.id = post.id;
            
            // Create flags HTML
            const flagsHTML = createFlagsHTML(post.flags || []);
            
            // Create type badge
            const typeHTML = createTypeBadge(post.type);
            
            row.innerHTML = `
                <td>${post.title}</td>
                <td>${typeHTML}</td>
                <td>${post.category || 'Uncategorized'}</td>
                <td><div class="content-flags">${flagsHTML}</div></td>
                <td>${post.popularity || 0}%</td>
                <td>${post.date || new Date().toISOString().split('T')[0]}</td>
                <td>
                    <div class="action-buttons">
                        <button class="btn btn-small btn-edit" onclick="editPost(${post.id})">
                            <span class="icon icon-edit"></span>
                            Edit
                        </button>
                        <button class="btn btn-small btn-delete" onclick="deletePost(${post.id})">
                            <span class="icon icon-delete"></span>
                            Delete
                        </button>
                    </div>
                </td>
            `;
            
            return row;
        }

        function createFlagsHTML(flags) {
            if (!flags || flags.length === 0) {
                return '<span style="color: #94a3b8; font-style: italic;">No flags</span>';
            }
            
            return flags.map(flag => {
                let flagClass = '';
                let flagText = '';
                
                switch(flag) {
                    case 'slideshow':
                        flagClass = 'flag-slideshow';
                        flagText = 'Slideshow';
                        break;
                    case 'featured':
                        flagClass = 'flag-slideshow';
                        flagText = 'Featured';
                        break;
                    case 'top-airing':
                        flagClass = 'flag-top-airing';
                        flagText = 'Top Airing';
                        break;
                    case 'latest':
                        flagClass = 'flag-latest';
                        flagText = 'Latest';
                        break;
                    case 'recommended':
                        flagClass = 'flag-recommended';
                        flagText = 'Recommended';
                        break;
                    default:
                        flagClass = 'flag-slideshow';
                        flagText = flag.charAt(0).toUpperCase() + flag.slice(1);
                }
                
                return `<span class="flag ${flagClass}">${flagText}</span>`;
            }).join('');
        }

        function createTypeBadge(type) {
            let typeClass = '';
            let typeText = '';
            
            switch(type) {
                case 'movie':
                    typeClass = 'post-type-movie';
                    typeText = 'Movie';
                    break;
                case 'anime':
                    typeClass = 'post-type-anime';
                    typeText = 'Anime';
                    break;
                case 'tv-show':
                    typeClass = 'post-type-tv-show';
                    typeText = 'TV Show';
                    break;
                case 'news':
                    typeClass = 'post-type-movie';
                    typeText = 'News';
                    break;
                case 'review':
                    typeClass = 'post-type-anime';
                    typeText = 'Review';
                    break;
                default:
                    typeClass = 'post-type-tv-show';
                    typeText = type.charAt(0).toUpperCase() + type.slice(1);
            }
            
            return `<span class="post-type-badge ${typeClass}">${typeText}</span>`;
        }

        function editPost(postId) {
            const post = postsData.find(p => p.id === postId);
            if (!post) {
                showNotification('Post not found', 'error');
                return;
            }
            
            showAddPostModal();
            
            // Populate form with post data
            setTimeout(() => {
                document.getElementById('post-title').value = post.title || '';
                document.getElementById('post-type').value = post.type || 'movie';
                document.getElementById('post-category').value = post.category || '';
                document.getElementById('post-year').value = post.year || '';
                document.getElementById('post-duration').value = post.duration || '';
                document.getElementById('post-rating').value = post.rating || '';
                document.getElementById('post-description').value = post.description || '';
                document.getElementById('post-poster').value = post.poster || '';
                document.getElementById('post-backdrop').value = post.backdrop || '';
                document.getElementById('post-genres').value = post.genres || '';
                document.getElementById('post-director').value = post.director || '';
                document.getElementById('post-trailer').value = post.trailer || '';
                document.getElementById('post-cast').value = post.cast || '';
                document.getElementById('post-tags').value = post.tags || '';
                document.getElementById('post-popularity').value = post.popularity || 50;
                popularityValue.textContent = post.popularity || 50;
                
                // Set flags
                if (post.flags && Array.isArray(post.flags)) {
                    const flags = post.flags;
                    document.querySelector('input[name="isFeatured"]').checked = flags.includes('featured');
                    document.querySelector('input[name="isSlideshow"]').checked = flags.includes('slideshow');
                    document.querySelector('input[name="isTopAiring"]').checked = flags.includes('top-airing');
                    document.querySelector('input[name="isLatestMovie"]').checked = flags.includes('latest');
                    document.querySelector('input[name="isRecommended"]').checked = flags.includes('recommended');
                }
                
                // Update form for editing
                const form = document.getElementById('add-post-form');
                form.dataset.editingId = postId;
                
                // Update button text
                const submitBtn = form.querySelector('button[type="submit"]');
                submitBtn.textContent = 'Update Post';
            }, 100);
            
            showNotification(`Editing post: ${post.title}`, 'info');
        }

        function deletePost(postId) {
            if (!confirm('Are you sure you want to delete this post?')) return;
            
            const index = postsData.findIndex(p => p.id === postId);
            if (index !== -1) {
                const postTitle = postsData[index].title;
                postsData.splice(index, 1);
                
                // Save to localStorage
                localStorage.setItem('quravel_posts', JSON.stringify(postsData));
                
                // Also delete from JSON file structure
                deletePostFromJson(postId);
                
                // Reload posts
                loadPosts();
                showNotification(`Post "${postTitle}" deleted successfully`, 'success');
            } else {
                showNotification('Post not found', 'error');
            }
        }

        function addNewPost(event) {
            event.preventDefault();
            
            const form = document.getElementById('add-post-form');
            const formData = new FormData(form);
            
            // Get form values
            const title = formData.get('title');
            const type = formData.get('type');
            const category = formData.get('category');
            
            // Validate required fields
            if (!title || !type || !category) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            // Collect flags
            const flags = [];
            if (formData.get('isFeatured')) flags.push('featured');
            if (formData.get('isSlideshow')) flags.push('slideshow');
            if (formData.get('isTopAiring')) flags.push('top-airing');
            if (formData.get('isLatestMovie')) flags.push('latest');
            if (formData.get('isRecommended')) flags.push('recommended');
            
            // Collect tags
            const tags = formData.get('tags') ? formData.get('tags').split(',').map(tag => tag.trim().toLowerCase()) : [];
            
            // Collect genres
            const genres = formData.get('genres') ? formData.get('genres').split(',').map(genre => genre.trim()) : [];
            
            // Collect cast
            const cast = formData.get('cast') ? formData.get('cast').split(',').map(actor => actor.trim()) : [];
            
            // Generate a URL-friendly ID
            const postId = generatePostId(title);
            
            // Check if editing existing post
            const editingId = form.dataset.editingId;
            
            if (editingId) {
                // Update existing post (localStorage)
                const index = postsData.findIndex(p => p.id === parseInt(editingId));
                
                if (index !== -1) {
                    postsData[index] = {
                        ...postsData[index],
                        id: parseInt(editingId),
                        title,
                        type,
                        category,
                        year: formData.get('year'),
                        duration: formData.get('duration'),
                        rating: parseFloat(formData.get('rating')) || 0,
                        description: formData.get('description'),
                        poster: formData.get('poster'),
                        backdrop: formData.get('backdrop'),
                        genres,
                        director: formData.get('director'),
                        trailer: formData.get('trailer'),
                        cast,
                        tags,
                        popularity: parseInt(formData.get('popularity')),
                        flags,
                        date: postsData[index].date || new Date().toISOString().split('T')[0]
                    };
                }
                
                // Also update in posts.json structure
                updatePostInJsonFile(editingId, {
                    id: postId,
                    title,
                    type,
                    category: category.toLowerCase(),
                    year: parseInt(formData.get('year')) || null,
                    duration: formData.get('duration') || '',
                    rating: parseFloat(formData.get('rating')) || 0,
                    description: formData.get('description') || '',
                    poster: formData.get('poster') || '',
                    backdrop: formData.get('backdrop') || '',
                    genres,
                    director: formData.get('director') || '',
                    cast,
                    trailer: formData.get('trailer') || '',
                    streamingUrl: `streaming.html?id=${postId}`,
                    dateAdded: new Date().toISOString().split('T')[0],
                    popularity: parseInt(formData.get('popularity')) || 50,
                    flags: {
                        isFeatured: flags.includes('featured'),
                        isSlideshow: flags.includes('slideshow'),
                        isTopAiring: flags.includes('top-airing'),
                        isLatestMovie: flags.includes('latest'),
                        isRecommended: flags.includes('recommended')
                    },
                    tags
                });
                
                showNotification(`Post "${title}" updated successfully!`, 'success');
            } else {
                // Add new post (localStorage)
                const newLocalId = postsData.length > 0 ? Math.max(...postsData.map(p => p.id)) + 1 : 1;
                
                const newPost = {
                    id: newLocalId,
                    title,
                    type,
                    category,
                    year: formData.get('year'),
                    duration: formData.get('duration'),
                    rating: parseFloat(formData.get('rating')) || 0,
                    description: formData.get('description'),
                    poster: formData.get('poster'),
                    backdrop: formData.get('backdrop'),
                    genres,
                    director: formData.get('director'),
                    trailer: formData.get('trailer'),
                    cast,
                    tags,
                    popularity: parseInt(formData.get('popularity')),
                    flags,
                    date: new Date().toISOString().split('T')[0]
                };
                
                postsData.unshift(newPost);
                
                // Also add to posts.json structure
                addPostToJsonFile({
                    id: postId,
                    title,
                    type,
                    category: category.toLowerCase(),
                    year: parseInt(formData.get('year')) || null,
                    duration: formData.get('duration') || '',
                    rating: parseFloat(formData.get('rating')) || 0,
                    description: formData.get('description') || '',
                    poster: formData.get('poster') || '',
                    backdrop: formData.get('backdrop') || '',
                    genres,
                    director: formData.get('director') || '',
                    cast,
                    trailer: formData.get('trailer') || '',
                    streamingUrl: `streaming.html?id=${postId}`,
                    dateAdded: new Date().toISOString().split('T')[0],
                    popularity: parseInt(formData.get('popularity')) || 50,
                    flags: {
                        isFeatured: flags.includes('featured'),
                        isSlideshow: flags.includes('slideshow'),
                        isTopAiring: flags.includes('top-airing'),
                        isLatestMovie: flags.includes('latest'),
                        isRecommended: flags.includes('recommended')
                    },
                    tags
                });
                
                showNotification(`Post "${title}" added successfully!`, 'success');
            }
            
            // Save to localStorage
            localStorage.setItem('quravel_posts', JSON.stringify(postsData));
            
            // Close modal
            closeAddPostModal();
            
            // Reload posts
            loadPosts();
        }

        // =============================================================================
        // COMPOSE MODAL FUNCTIONS
        // =============================================================================

        function initializeEditors() {
            // Initialize Quill editor
            if (typeof Quill !== 'undefined' && document.getElementById('content-editor')) {
                quillEditor = new Quill('#content-editor', {
                    theme: 'snow',
                    modules: {
                        toolbar: [
                            [{ 'header': [1, 2, 3, false] }],
                            ['bold', 'italic', 'underline'],
                            [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                            ['link', 'image'],
                            ['clean']
                        ]
                    },
                    placeholder: 'Write your content here...'
                });
            }
        }

        function showComposeModal() {
            composeModal.classList.add('active');
            document.body.style.overflow = 'hidden';
            switchComposeMode('template');
            
            // Load categories
            loadCategories();
        }

        function closeComposeModal() {
            composeModal.classList.remove('active');
            document.body.style.overflow = 'auto';
            resetComposeForm();
        }

        function switchComposeMode(mode) {
            currentComposeMode = mode;
            
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => {
                if (btn.onclick && btn.onclick.toString().includes(mode)) {
                    btn.classList.add('active');
                }
            });
            
            // Update mode content
            document.querySelectorAll('.compose-mode').forEach(modeDiv => modeDiv.classList.remove('active'));
            document.getElementById(`${mode}-mode`).classList.add('active');
            
            if (mode === 'html') {
                // Load default HTML or draft
                const defaultHTML = `<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        h1 { color: #8b5cf6; }
        .content { max-width: 800px; margin: 0 auto; }
    </style>
</head>
<body>
    <div class="content">
        <h1>Your Content Title</h1>
        <p>Start writing your HTML content here...</p>
    </div>
</body>
</html>`;
                
                htmlEditor.value = defaultHTML;
            }
        }

        function selectTemplate(templateType) {
            selectedTemplate = templateType;
            
            // Update template selection UI
            document.querySelectorAll('.template-card').forEach(card => {
                card.classList.remove('selected');
                if (card.onclick && card.onclick.toString().includes(templateType)) {
                    card.classList.add('selected');
                }
            });
            
            // Show template editor
            document.getElementById('template-editor').style.display = 'block';
            
            // Load template-specific defaults
            loadTemplateDefaults(templateType);
        }

        function loadTemplateDefaults(templateType) {
            const titleInput = document.getElementById('compose-title');
            const typeSelect = document.getElementById('compose-type');
            
            switch(templateType) {
                case 'movie-card':
                    titleInput.placeholder = 'Enter movie title...';
                    typeSelect.value = 'movie';
                    break;
                case 'tv-show':
                    titleInput.placeholder = 'Enter TV show title...';
                    typeSelect.value = 'tv-show';
                    break;
                case 'news-article':
                    titleInput.placeholder = 'Enter article title...';
                    typeSelect.value = 'news';
                    break;
                case 'custom':
                    titleInput.placeholder = 'Enter custom content title...';
                    typeSelect.value = '';
                    break;
            }
        }

        function formatHTML() {
            // Simple HTML formatting
            const content = htmlEditor.value;
            const formatted = formatHtmlContent(content);
            htmlEditor.value = formatted;
            showNotification('HTML formatted successfully', 'success');
        }

        function validateHTML() {
            const content = htmlEditor.value.trim();
            if (!content) {
                showNotification('HTML editor is empty', 'warning');
                return;
            }
            
            // Simple validation - check for basic HTML tags
            const hasOpeningTags = content.includes('<');
            const hasClosingTags = content.includes('>');
            
            if (hasOpeningTags && hasClosingTags) {
                showNotification('HTML appears to be valid', 'success');
            } else {
                showNotification('HTML may be incomplete', 'warning');
            }
        }

        function previewHTML() {
            const content = htmlEditor.value;
            const previewDiv = document.getElementById('html-preview');
            
            if (!content.trim()) {
                showNotification('No HTML content to preview', 'warning');
                return;
            }
            
            // Show preview section
            previewDiv.style.display = 'block';
            
            // Write HTML to iframe
            const iframeDoc = previewFrame.contentDocument || previewFrame.contentWindow.document;
            iframeDoc.open();
            iframeDoc.write(content);
            iframeDoc.close();
            
            showNotification('HTML preview generated', 'info');
            
            // Scroll to preview
            previewDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function formatHtmlContent(html) {
            // Basic HTML formatting
            return html
                .replace(/>\s+</g, '>\n<')
                .replace(/(<\/\w+>)/g, '$1\n')
                .split('\n')
                .map(line => line.trim())
                .filter(line => line.length > 0)
                .map((line, index) => {
                    const indentLevel = (line.match(/<\//) ? -1 : 0) + (line.match(/<\w+[^>]*[^/]>/) ? 0 : 0);
                    const spaces = '  '.repeat(Math.max(0, indentLevel));
                    return spaces + line;
                })
                .join('\n');
        }

        function saveAsDraft() {
            const formData = collectComposeFormData();
            formData.mode = currentComposeMode;
            formData.template = selectedTemplate;
            formData.draft = true;
            formData.lastModified = new Date().toISOString();
            
            // Save to localStorage
            const drafts = JSON.parse(localStorage.getItem('quravel_content_drafts') || '[]');
            drafts.push(formData);
            localStorage.setItem('quravel_content_drafts', JSON.stringify(drafts));
            
            showNotification('Draft saved successfully', 'success');
        }

        function publishContent() {
            const formData = collectComposeFormData();
            
            // Validate required fields
            if (!formData.title || !formData.type) {
                showNotification('Title and Type are required fields', 'error');
                return;
            }
            
            formData.published = true;
            formData.publishedAt = new Date().toISOString();
            formData.id = postsData.length > 0 ? Math.max(...postsData.map(p => p.id)) + 1 : 1;
            
            // Convert to post format
            const newPost = {
                id: formData.id,
                title: formData.title,
                type: formData.type,
                category: formData.category,
                description: formData.contentText || formData.description,
                rating: parseFloat(formData.rating) || 0,
                year: formData.year,
                poster: formData.poster,
                backdrop: formData.backdrop,
                tags: formData.tags ? formData.tags.split(',').map(tag => tag.trim()) : [],
                popularity: 50, // Default
                flags: [],
                date: new Date().toISOString().split('T')[0]
            };
            
            // Add flags
            if (formData.isFeatured) newPost.flags.push('featured');
            if (formData.isRecommended) newPost.flags.push('recommended');
            if (formData.isTopAiring) newPost.flags.push('top-airing');
            
            // Add to posts
            postsData.unshift(newPost);
            localStorage.setItem('quravel_posts', JSON.stringify(postsData));
            
            // Also add to JSON file structure
            const postId = generatePostId(formData.title);
            addPostToJsonFile({
                id: postId,
                title: formData.title,
                type: formData.type,
                category: formData.category.toLowerCase(),
                year: parseInt(formData.year) || null,
                duration: '',
                rating: parseFloat(formData.rating) || 0,
                description: formData.contentText || formData.description || '',
                poster: formData.poster || '',
                backdrop: formData.backdrop || '',
                genres: [],
                director: '',
                cast: [],
                trailer: '',
                streamingUrl: `streaming.html?id=${postId}`,
                dateAdded: new Date().toISOString().split('T')[0],
                popularity: 50,
                flags: {
                    isFeatured: formData.isFeatured || false,
                    isSlideshow: false,
                    isTopAiring: formData.isTopAiring || false,
                    isLatestMovie: false,
                    isRecommended: formData.isRecommended || false
                },
                tags: formData.tags ? formData.tags.split(',').map(tag => tag.trim().toLowerCase()) : []
            });
            
            // Clear draft if exists
            contentDraft = null;
            
            closeComposeModal();
            showNotification('Content published successfully', 'success');
            
            // Refresh posts table
            loadPosts();
        }

        function collectComposeFormData() {
            const form = document.getElementById('template-form');
            const formData = new FormData(form);
            const data = {};
            
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            // Add checkbox values
            data.isFeatured = document.querySelector('input[name="isFeatured"]').checked;
            data.isRecommended = document.querySelector('input[name="isRecommended"]').checked;
            data.isTopAiring = document.querySelector('input[name="isTopAiring"]').checked;
            
            // Add content from editors
            if (currentComposeMode === 'template' && quillEditor) {
                data.contentHtml = quillEditor.root.innerHTML;
                data.contentText = quillEditor.getText();
            } else if (currentComposeMode === 'html') {
                data.htmlContent = htmlEditor.value;
            }
            
            return data;
        }

        function resetComposeForm() {
            // Clear form fields
            const form = document.getElementById('template-form');
            if (form) form.reset();
            
            // Clear editors
            if (quillEditor) {
                quillEditor.setContents([]);
            }
            if (htmlEditor) {
                htmlEditor.value = '';
            }
            
            // Hide template editor
            document.getElementById('template-editor').style.display = 'none';
            
            // Reset template selection
            document.querySelectorAll('.template-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Hide HTML preview
            const preview = document.getElementById('html-preview');
            if (preview) {
                preview.style.display = 'none';
            }
            
            // Reset mode
            currentComposeMode = 'template';
            selectedTemplate = '';
        }

        // =============================================================================
        // TEMPLATES MANAGEMENT FUNCTIONS
        // =============================================================================

        function loadTemplates() {
            savedTemplates = JSON.parse(localStorage.getItem('quravel_templates')) || [];
            updateTemplatesDisplay();
        }

        function updateTemplatesDisplay() {
            if (!savedTemplatesContainer) return;
            
            savedTemplatesContainer.innerHTML = '';
            
            if (savedTemplates.length === 0) {
                savedTemplatesContainer.innerHTML = '<div class="no-templates">No templates saved yet. Create your first template!</div>';
                return;
            }
            
            savedTemplates.forEach((template, index) => {
                const templateCard = createTemplateCardElement(template, index);
                savedTemplatesContainer.appendChild(templateCard);
            });
        }

        function createTemplateCardElement(template, index) {
            const card = document.createElement('div');
            card.className = 'saved-template-card';
            card.innerHTML = `
                <div class="template-info">
                    <h4>${template.name || 'Unnamed Template'}</h4>
                    <p>${template.type || 'custom'} template</p>
                    <span class="template-date">${template.created ? new Date(template.created).toLocaleDateString() : 'Unknown date'}</span>
                </div>
                <div class="template-actions">
                    <button class="btn btn-small btn-secondary" onclick="editTemplate(${index})">Edit</button>
                    <button class="btn btn-small btn-secondary" onclick="duplicateTemplate(${index})">Duplicate</button>
                    <button class="btn btn-small btn-delete" onclick="deleteTemplate(${index})">Delete</button>
                </div>
            `;
            return card;
        }

        function manageTemplates() {
            loadTemplates();
            templatesModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeTemplatesModal() {
            templatesModal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function createNewTemplate() {
            const templateName = prompt('Enter template name:');
            if (!templateName) return;
            
            // Get current content
            let htmlContent = '';
            if (currentComposeMode === 'template' && quillEditor) {
                htmlContent = quillEditor.root.innerHTML;
            } else if (currentComposeMode === 'html') {
                htmlContent = htmlEditor.value;
            }
            
            const template = {
                id: Date.now(),
                name: templateName,
                type: selectedTemplate || 'custom',
                html: htmlContent || generateDefaultHTML(),
                fields: collectComposeFormData(),
                created: new Date().toISOString()
            };
            
            savedTemplates.push(template);
            localStorage.setItem('quravel_templates', JSON.stringify(savedTemplates));
            updateTemplatesDisplay();
            showNotification('Template created successfully', 'success');
        }

        function editTemplate(index) {
            const template = savedTemplates[index];
            if (!template) return;
            
            // Load template into compose mode
            closeTemplatesModal();
            showComposeModal();
            
            // Switch to HTML mode and load content
            setTimeout(() => {
                switchComposeMode('html');
                htmlEditor.value = template.html || generateDefaultHTML();
                
                // Load form fields if available
                if (template.fields) {
                    populateComposeFormFields(template.fields);
                }
            }, 100);
        }

        function duplicateTemplate(index) {
            const template = savedTemplates[index];
            if (!template) return;
            
            const newTemplate = {
                ...template,
                id: Date.now(),
                name: template.name + ' (Copy)',
                created: new Date().toISOString()
            };
            
            savedTemplates.push(newTemplate);
            localStorage.setItem('quravel_templates', JSON.stringify(savedTemplates));
            updateTemplatesDisplay();
            showNotification('Template duplicated successfully', 'success');
        }

        function deleteTemplate(index) {
            if (!confirm('Are you sure you want to delete this template?')) return;
            
            savedTemplates.splice(index, 1);
            localStorage.setItem('quravel_templates', JSON.stringify(savedTemplates));
            updateTemplatesDisplay();
            showNotification('Template deleted successfully', 'success');
        }

        function importTemplate() {
            showNotification('Template import functionality would open a file dialog in a real application', 'info');
        }

        function exportAllTemplates() {
            if (savedTemplates.length === 0) {
                showNotification('No templates to export', 'warning');
                return;
            }
            
            const dataStr = JSON.stringify(savedTemplates, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', 'quravel-templates.json');
            linkElement.click();
            
            showNotification('Templates exported successfully', 'success');
        }

        function populateComposeFormFields(data) {
            Object.keys(data).forEach(key => {
                const element = document.getElementById(`compose-${key}`);
                if (element) {
                    if (element.type === 'checkbox') {
                        element.checked = Boolean(data[key]);
                    } else {
                        element.value = data[key] || '';
                    }
                }
            });
            
            // Set rich text content
            if (data.contentHtml && quillEditor) {
                quillEditor.root.innerHTML = data.contentHtml;
            }
        }

        function generateDefaultHTML() {
            return `<!DOCTYPE html>
<html>
<head>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .content-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #8b5cf6;
            border-bottom: 3px solid #8b5cf6;
            padding-bottom: 10px;
        }
        .meta-info {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            color: #666;
        }
        .content-body {
            margin-top: 30px;
        }
        .content-body p {
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="content-container">
        <h1>Your Content Title</h1>
        <div class="meta-info">
            <span>Type: Movie</span>
            <span>Rating: 8.5/10</span>
            <span>Year: 2024</span>
        </div>
        <div class="content-body">
            <p>This is your content. Start writing here...</p>
            <p>You can add more paragraphs, images, lists, and other HTML elements.</p>
        </div>
    </div>
</body>
</html>`;
        }

        // =============================================================================
        // JSON FILE INTEGRATION FUNCTIONS
        // =============================================================================

        // Helper function to generate URL-friendly ID from title
        function generatePostId(title) {
            return title
                .toLowerCase()
                .replace(/[^a-z0-9\s-]/g, '') // Remove special characters
                .replace(/\s+/g, '-')         // Replace spaces with hyphens
                .replace(/-+/g, '-')          // Remove consecutive hyphens
                .trim();
        }

        // Function to load posts.json data
        function loadJsonPostsData() {
            // In a real application, this would be an API call
            // For now, we'll use localStorage as a simulated backend
            return JSON.parse(localStorage.getItem('quravel_json_posts')) || {
                posts: [],
                categories: {
                    movies: ["action", "sci-fi", "comedy", "drama", "thriller", "horror", "romance", "adventure"],
                    anime: ["action", "romance", "comedy", "drama", "thriller", "fantasy", "isekai", "slice-of-life"],
                    "tv-shows": ["drama", "comedy", "thriller", "sci-fi", "reality", "documentary"]
                },
                contentFlags: {
                    slideshow: "Featured content for homepage hero carousel",
                    topAiring: "Currently popular/running series",
                    latestMovie: "Recently released movies",
                    recommended: "Editor picks and recommendations"
                }
            };
        }

        // Function to save posts.json data
        function saveJsonPostsData(data) {
            localStorage.setItem('quravel_json_posts', JSON.stringify(data, null, 2));
        }

        // Function to add a new post to posts.json structure
        function addPostToJsonFile(postData) {
            const jsonData = loadJsonPostsData();
            
            // Check if post with same ID already exists
            const existingIndex = jsonData.posts.findIndex(post => post.id === postData.id);
            
            if (existingIndex === -1) {
                // Add new post
                jsonData.posts.push(postData);
                saveJsonPostsData(jsonData);
                console.log(`Post "${postData.title}" added to JSON file structure`);
                
                // Also update categories if needed
                updateCategoriesInJson(jsonData, postData.category, postData.type);
            } else {
                // Update existing post
                jsonData.posts[existingIndex] = postData;
                saveJsonPostsData(jsonData);
                console.log(`Post "${postData.title}" updated in JSON file structure`);
            }
            
            // Export to downloadable file (for demonstration)
            exportJsonToFile(jsonData);
        }

        // Function to update existing post in posts.json
        function updatePostInJsonFile(oldId, postData) {
            const jsonData = loadJsonPostsData();
            const existingIndex = jsonData.posts.findIndex(post => post.id === oldId);
            
            if (existingIndex !== -1) {
                jsonData.posts[existingIndex] = postData;
                saveJsonPostsData(jsonData);
                console.log(`Post "${postData.title}" updated in JSON file structure`);
                
                // Export to downloadable file
                exportJsonToFile(jsonData);
            }
        }

        // Function to delete post from JSON
        function deletePostFromJson(postId) {
            const jsonData = loadJsonPostsData();
            const postTitle = postsData.find(p => p.id === postId)?.title;
            
            // Find and remove post by ID
            const initialLength = jsonData.posts.length;
            jsonData.posts = jsonData.posts.filter(post => post.id !== postId.toString() && post.id !== postId);
            
            if (jsonData.posts.length < initialLength) {
                saveJsonPostsData(jsonData);
                console.log(`Post "${postTitle}" deleted from JSON file structure`);
                
                // Export to downloadable file
                exportJsonToFile(jsonData);
            }
        }

        // Function to update categories in JSON data
        function updateCategoriesInJson(jsonData, category, type) {
            if (!category || !type) return;
            
            const categoryKey = type === 'movie' ? 'movies' : 
                               type === 'anime' ? 'anime' : 
                               type === 'tv-show' ? 'tv-shows' : null;
            
            if (categoryKey && jsonData.categories[categoryKey]) {
                const categoryLower = category.toLowerCase();
                if (!jsonData.categories[categoryKey].includes(categoryLower)) {
                    jsonData.categories[categoryKey].push(categoryLower);
                    saveJsonPostsData(jsonData);
                }
            }
        }

        // Function to export JSON data to a downloadable file
        function exportJsonToFile(jsonData) {
            // This creates a downloadable JSON file
            const dataStr = JSON.stringify(jsonData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            // Store for later download
            localStorage.setItem('quravel_json_export', dataStr);
            
            console.log('JSON data updated. Use "Export Data" button to download updated posts.json file.');
        }

        // =============================================================================
        // UTILITY FUNCTIONS
        // =============================================================================

        function loadCategories() {
            const categories = ['Action', 'Adventure', 'Comedy', 'Drama', 'Fantasy', 'Horror', 'Mystery', 'Romance', 'Sci-Fi', 'Thriller', 'Documentary', 'Animation'];
            
            const categorySelects = document.querySelectorAll('select[id$="category"]');
            categorySelects.forEach(select => {
                // Clear existing options except the first one
                while (select.options.length > 1) {
                    select.remove(1);
                }
                
                // Add categories
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category.toLowerCase();
                    option.textContent = category;
                    select.appendChild(option);
                });
            });
        }

        function setupNavigationScroll() {
            const nav = adminNav;
            const scrollAmount = 200;
            
            scrollLeftBtn.addEventListener('click', () => {
                nav.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
            });
            
            scrollRightBtn.addEventListener('click', () => {
                nav.scrollBy({ left: scrollAmount, behavior: 'smooth' });
            });
            
            // Show/hide scroll buttons based on scroll position
            nav.addEventListener('scroll', () => {
                scrollLeftBtn.style.display = nav.scrollLeft > 0 ? 'flex' : 'none';
                scrollRightBtn.style.display = 
                    nav.scrollLeft < (nav.scrollWidth - nav.clientWidth) ? 'flex' : 'none';
            });
            
            // Initial state
            scrollLeftBtn.style.display = 'none';
            scrollRightBtn.style.display = nav.scrollWidth > nav.clientWidth ? 'flex' : 'none';
        }

        function setupEventListeners() {
            // Add post form submission
            const addPostForm = document.getElementById('add-post-form');
            if (addPostForm) {
                addPostForm.addEventListener('submit', addNewPost);
            }
            
            // Popularity slider
            if (postPopularity && popularityValue) {
                postPopularity.addEventListener('input', function() {
                    popularityValue.textContent = this.value;
                });
            }
            
            // Modal close on click outside
            document.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.classList.remove('active');
                    document.body.style.overflow = 'auto';
                }
            });
            
            // Close modals with Escape key
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    document.querySelectorAll('.modal.active').forEach(modal => {
                        modal.classList.remove('active');
                        document.body.style.overflow = 'auto';
                    });
                }
            });
        }

        function showAddPostModal() {
            addPostModal.classList.add('active');
            document.body.style.overflow = 'hidden';
            loadCategories();
            
            // Reset form for new post
            const form = document.getElementById('add-post-form');
            form.reset();
            delete form.dataset.editingId;
            
            // Reset popularity value
            if (postPopularity && popularityValue) {
                postPopularity.value = 50;
                popularityValue.textContent = '50';
            }
            
            // Update button text
            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.textContent = 'Add Post';
        }

        function closeAddPostModal() {
            addPostModal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function importPosts() {
            showNotification('Import posts functionality would open a file dialog in a real application', 'info');
        }

        function exportPosts() {
            // Get combined data (both localStorage posts and JSON structure)
            const localStoragePosts = JSON.parse(localStorage.getItem('quravel_posts')) || [];
            const jsonData = loadJsonPostsData();
            
            // Merge data for export
            const exportData = {
                ...jsonData,
                // You could add metadata about the export
                exportDate: new Date().toISOString(),
                totalPosts: jsonData.posts.length + localStoragePosts.length
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', 'quravel-posts-export.json');
            linkElement.click();
            
            showNotification('Posts exported successfully with JSON structure', 'success');
        }

        function showNotification(message, type = 'info') {
            // Remove existing notifications
            document.querySelectorAll('.notification').forEach(notification => {
                notification.remove();
            });
            
            // Create notification
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                ${message}
                <button onclick="this.parentElement.remove()">&times;</button>
            `;
            
            document.body.appendChild(notification);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }

        // =============================================================================
        // DEBOUNCE AND THROTTLE UTILITIES (from main.js)
        // =============================================================================

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function throttle(func, limit) {
            let inThrottle;
            return function() {
                const args = arguments;
                const context = this;
                if (!inThrottle) {
                    func.apply(context, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            };
        }

        // =============================================================================
        // PERFORMANCE OPTIMIZATIONS (from main.js)
        // =============================================================================

        function optimizeImages() {
            const images = document.querySelectorAll('img[loading="lazy"]');
            
            if ('IntersectionObserver' in window) {
                const imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            img.src = img.dataset.src || img.src;
                            img.classList.remove('lazy');
                            imageObserver.unobserve(img);
                        }
                    });
                });

                images.forEach(img => imageObserver.observe(img));
            }
        }

        // Initialize performance optimizations
        document.addEventListener('DOMContentLoaded', () => {
            optimizeImages();
        });
    </script>
</body>
</html>